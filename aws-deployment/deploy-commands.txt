# CryptoEscrow Backend Deployment Commands
# Copy and customize these commands for your deployment

# 1. Deploy CloudFormation Stack
aws cloudformation create-stack \
  --stack-name cryptoescrow-infrastructure \
  --template-body file://cloudformation.yaml \
  --parameters ParameterKey=KeyPairName,ParameterValue=YOUR_KEY_PAIR_NAME \
               ParameterKey=InstanceType,ParameterValue=t3.small \
               ParameterKey=AllowedSSHCIDR,ParameterValue=YOUR_IP/32 \
  --capabilities CAPABILITY_NAMED_IAM \
  --region us-east-1

# 2. Wait for completion
aws cloudformation wait stack-create-complete \
  --stack-name cryptoescrow-infrastructure \
  --region us-east-1

# 3. Get outputs
aws cloudformation describe-stacks \
  --stack-name cryptoescrow-infrastructure \
  --query 'Stacks[0].Outputs' \
  --region us-east-1

# 4. Update secrets (replace with your actual values)
aws secretsmanager update-secret \
  --secret-id "CryptoEscrow/App/Config" \
  --secret-string '{"JWT_SECRET":"YOUR_JWT_SECRET","ENCRYPTION_KEY":"YOUR_ENCRYPTION_KEY","DATABASE_ENCRYPTION_KEY":"YOUR_DB_KEY","SMTP_HOST":"smtp.gmail.com","SMTP_PORT":"587","SMTP_USER":"your-email@gmail.com","SMTP_PASS":"your-password","INFURA_API_KEY":"your-infura-key","ALCHEMY_API_KEY":"your-alchemy-key"}' \
  --region us-east-1

aws secretsmanager update-secret \
  --secret-id "CryptoEscrow/Blockchain/Keys" \
  --secret-string '{"DEPLOYER_PRIVATE_KEY":"your-deployer-key","BACKEND_WALLET_PRIVATE_KEY":"your-backend-key"}' \
  --region us-east-1

# 5. SSH and deploy
ssh -i path/to/your-key.pem ec2-user@YOUR_EC2_IP
# Then run the deployment script on the server
