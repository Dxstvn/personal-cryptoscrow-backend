f000ab421b65295dd7d5cb591cde0819
// src/services/__tests__/databaseService.test.js
import { jest, describe, it, expect, beforeEach, afterAll, beforeAll } from '@jest/globals';
import { Timestamp } from 'firebase-admin/firestore';
import admin from 'firebase-admin'; // Import admin
import { adminFirestore, PROJECT_ID } from '../../../../jest.emulator.setup.js'; // Adjust path as needed
import { getDealsPastFinalApproval, getDealsPastDisputeDeadline, updateDealStatusInDB } from '../../databaseService.js'; // Adjust path as needed
import { deleteAdminApp } from '../../../api/routes/auth/admin.js'; // Adjust path as needed

// Helper to clean up Firestore data
async function cleanUpFirestore() {
  const collections = await adminFirestore.listCollections();
  for (const collection of collections) {
    if (collection.id === 'deals') {
      // Only clear 'deals' for these tests
      const docs = await collection.listDocuments();
      const deletePromises = docs.map(doc => doc.delete());
      await Promise.all(deletePromises);
    }
  }
}
describe('Database Service Tests', () => {
  // Use a unique collection name for tests if needed, or ensure clean slate
  const dealsCollection = adminFirestore.collection('deals');
  // let db; // This was not used meaningfully

  beforeAll(async () => {
    // Ensure emulators are running and connected
    console.log(`[DB Service Tests] Using Project ID: ${PROJECT_ID} and Firestore emulator.`);

    // Initialize Firebase Admin SDK for tests if not already initialized
    // This ensures that admin.firestore() in databaseService.js can find the default app
    const DEFAULT_APP_NAME = '[DEFAULT]';
    if (!admin.apps.find(app => app && app.name === DEFAULT_APP_NAME)) {
      console.log(`[DB Service Tests BeforeAll] Initializing default Firebase app for databaseService tests.`);
      admin.initializeApp({
        projectId: PROJECT_ID || `db-service-tests-${Date.now()}` // Use PROJECT_ID from emulator setup
        // Add other configurations if necessary, e.g., storageBucket, but FIRESTORE_EMULATOR_HOST should be picked up
      });
    } else {
      console.log(`[DB Service Tests BeforeAll] Default Firebase app already initialized.`);
    }

    // databaseService.js, when NODE_ENV === 'test', should now pick up
    // the default app initialized by jest.emulator.setup.js or by the code above.
  });
  beforeEach(async () => {
    await cleanUpFirestore(); // Clear 'deals' collection before each test
  });
  afterAll(async () => {
    await cleanUpFirestore();
    // If adminApp was initialized by databaseService or its imports, ensure it's cleaned up
    // This might be handled by a global afterAll in jest.setup.js if adminApp is shared
    // For now, assuming jest.emulator.setup.js handles its own adminApp lifecycle or it's managed elsewhere.
    // await deleteAdminApp(); // Uncomment if adminApp used by service needs explicit cleanup here
  });
  describe('getDealsPastFinalApproval', () => {
    it('should return deals that are IN_FINAL_APPROVAL and past their deadline', async () => {
      const now = Timestamp.now();
      const oneHourAgo = Timestamp.fromMillis(now.toMillis() - 60 * 60 * 1000);
      const oneHourFromNow = Timestamp.fromMillis(now.toMillis() + 60 * 60 * 1000);
      await dealsCollection.doc('deal1').set({
        status: 'IN_FINAL_APPROVAL',
        finalApprovalDeadlineBackend: oneHourAgo,
        // Past deadline
        propertyAddress: '123 Main St'
      });
      await dealsCollection.doc('deal2').set({
        status: 'IN_FINAL_APPROVAL',
        finalApprovalDeadlineBackend: oneHourFromNow,
        // Future deadline
        propertyAddress: '456 Oak Ave'
      });
      await dealsCollection.doc('deal3').set({
        status: 'AWAITING_FULFILLMENT',
        // Wrong status
        finalApprovalDeadlineBackend: oneHourAgo,
        propertyAddress: '789 Pine Ln'
      });
      await dealsCollection.doc('deal4').set({
        status: 'IN_FINAL_APPROVAL',
        finalApprovalDeadlineBackend: oneHourAgo,
        // Past deadline
        propertyAddress: '101 Maple Dr'
      });
      await dealsCollection.doc('deal5').set({
        status: 'IN_FINAL_APPROVAL',
        // No deadline set, should not be picked up
        propertyAddress: '202 Birch Rd'
      });
      const deals = await getDealsPastFinalApproval();
      expect(deals).toHaveLength(2);
      expect(deals.map(d => d.id).sort()).toEqual(['deal1', 'deal4'].sort());
    });
    it('should return an empty array if no deals match', async () => {
      const now = Timestamp.now();
      const oneHourFromNow = Timestamp.fromMillis(now.toMillis() + 60 * 60 * 1000);
      await dealsCollection.doc('deal1').set({
        status: 'IN_FINAL_APPROVAL',
        finalApprovalDeadlineBackend: oneHourFromNow
      });
      const deals = await getDealsPastFinalApproval();
      expect(deals).toHaveLength(0);
    });
  });
  describe('getDealsPastDisputeDeadline', () => {
    it('should return deals that are IN_DISPUTE and past their deadline', async () => {
      const now = Timestamp.now();
      const oneDayAgo = Timestamp.fromMillis(now.toMillis() - 24 * 60 * 60 * 1000);
      const oneDayFromNow = Timestamp.fromMillis(now.toMillis() + 24 * 60 * 60 * 1000);
      await dealsCollection.doc('dispute1').set({
        status: 'IN_DISPUTE',
        disputeResolutionDeadlineBackend: oneDayAgo,
        // Past deadline
        propertyAddress: 'Dispute Prop 1'
      });
      await dealsCollection.doc('dispute2').set({
        status: 'IN_DISPUTE',
        disputeResolutionDeadlineBackend: oneDayFromNow,
        // Future deadline
        propertyAddress: 'Dispute Prop 2'
      });
      await dealsCollection.doc('dispute3').set({
        status: 'IN_FINAL_APPROVAL',
        // Wrong status
        disputeResolutionDeadlineBackend: oneDayAgo,
        propertyAddress: 'Dispute Prop 3'
      });
      const deals = await getDealsPastDisputeDeadline();
      expect(deals).toHaveLength(1);
      expect(deals[0].id).toBe('dispute1');
    });
    it('should return an empty array if no deals match', async () => {
      const deals = await getDealsPastDisputeDeadline();
      expect(deals).toHaveLength(0);
    });
  });
  describe('updateDealStatusInDB', () => {
    it('should update deal status and add a timeline event', async () => {
      const dealId = 'dealToUpdate';
      await dealsCollection.doc(dealId).set({
        status: 'IN_FINAL_APPROVAL',
        propertyAddress: 'Update Test Prop',
        timeline: []
      });
      const newStatus = 'COMPLETED';
      const eventMessage = 'Deal automatically completed.';
      const txHash = '0x123abc';
      await updateDealStatusInDB(dealId, {
        status: newStatus,
        timelineEventMessage: eventMessage,
        autoReleaseTxHash: txHash // Assuming this is the relevant hash field based on usage
      });
      const updatedDeal = await dealsCollection.doc(dealId).get();
      expect(updatedDeal.exists).toBe(true);
      const dealData = updatedDeal.data();
      expect(dealData.status).toBe(newStatus);
      expect(dealData.updatedAt).toBeInstanceOf(Timestamp);
      expect(dealData.timeline).toHaveLength(1);
      expect(dealData.timeline[0].event).toBe(eventMessage);
      expect(dealData.timeline[0].systemTriggered).toBe(true);
      expect(dealData.timeline[0].transactionHash).toBe(txHash);
      expect(dealData.timeline[0].timestamp).toBeInstanceOf(Timestamp);
    });
    it('should not throw if dealId is invalid but log an error (or handle as per implementation)', async () => {
      const consoleErrorSpy = jest.spyOn(console, 'error').mockImplementation(() => {});
      await updateDealStatusInDB(null, {
        status: 'COMPLETED',
        timelineEventMessage: 'Test event'
      });
      expect(consoleErrorSpy).toHaveBeenCalledWith("[DBService] Invalid parameters for updateDealStatusInDB:", expect.objectContaining({
        dealId: null,
        updateData: expect.objectContaining({
          status: 'COMPLETED'
        })
      }));
      consoleErrorSpy.mockRestore();
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqZXN0IiwiZGVzY3JpYmUiLCJpdCIsImV4cGVjdCIsImJlZm9yZUVhY2giLCJhZnRlckFsbCIsImJlZm9yZUFsbCIsIlRpbWVzdGFtcCIsImFkbWluIiwiYWRtaW5GaXJlc3RvcmUiLCJQUk9KRUNUX0lEIiwiZ2V0RGVhbHNQYXN0RmluYWxBcHByb3ZhbCIsImdldERlYWxzUGFzdERpc3B1dGVEZWFkbGluZSIsInVwZGF0ZURlYWxTdGF0dXNJbkRCIiwiZGVsZXRlQWRtaW5BcHAiLCJjbGVhblVwRmlyZXN0b3JlIiwiY29sbGVjdGlvbnMiLCJsaXN0Q29sbGVjdGlvbnMiLCJjb2xsZWN0aW9uIiwiaWQiLCJkb2NzIiwibGlzdERvY3VtZW50cyIsImRlbGV0ZVByb21pc2VzIiwibWFwIiwiZG9jIiwiZGVsZXRlIiwiUHJvbWlzZSIsImFsbCIsImRlYWxzQ29sbGVjdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJERUZBVUxUX0FQUF9OQU1FIiwiYXBwcyIsImZpbmQiLCJhcHAiLCJuYW1lIiwiaW5pdGlhbGl6ZUFwcCIsInByb2plY3RJZCIsIkRhdGUiLCJub3ciLCJvbmVIb3VyQWdvIiwiZnJvbU1pbGxpcyIsInRvTWlsbGlzIiwib25lSG91ckZyb21Ob3ciLCJzZXQiLCJzdGF0dXMiLCJmaW5hbEFwcHJvdmFsRGVhZGxpbmVCYWNrZW5kIiwicHJvcGVydHlBZGRyZXNzIiwiZGVhbHMiLCJ0b0hhdmVMZW5ndGgiLCJkIiwic29ydCIsInRvRXF1YWwiLCJvbmVEYXlBZ28iLCJvbmVEYXlGcm9tTm93IiwiZGlzcHV0ZVJlc29sdXRpb25EZWFkbGluZUJhY2tlbmQiLCJ0b0JlIiwiZGVhbElkIiwidGltZWxpbmUiLCJuZXdTdGF0dXMiLCJldmVudE1lc3NhZ2UiLCJ0eEhhc2giLCJ0aW1lbGluZUV2ZW50TWVzc2FnZSIsImF1dG9SZWxlYXNlVHhIYXNoIiwidXBkYXRlZERlYWwiLCJnZXQiLCJleGlzdHMiLCJkZWFsRGF0YSIsImRhdGEiLCJ1cGRhdGVkQXQiLCJ0b0JlSW5zdGFuY2VPZiIsImV2ZW50Iiwic3lzdGVtVHJpZ2dlcmVkIiwidHJhbnNhY3Rpb25IYXNoIiwidGltZXN0YW1wIiwiY29uc29sZUVycm9yU3B5Iiwic3B5T24iLCJtb2NrSW1wbGVtZW50YXRpb24iLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsIm9iamVjdENvbnRhaW5pbmciLCJ1cGRhdGVEYXRhIiwibW9ja1Jlc3RvcmUiXSwic291cmNlcyI6WyJkYXRhYmFzZVNlcnZpY2UuaW50ZWdyYXRpb24udGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvc2VydmljZXMvX190ZXN0c19fL2RhdGFiYXNlU2VydmljZS50ZXN0LmpzXG5pbXBvcnQgeyBqZXN0LCBkZXNjcmliZSwgaXQsIGV4cGVjdCwgYmVmb3JlRWFjaCwgYWZ0ZXJBbGwsIGJlZm9yZUFsbCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHsgVGltZXN0YW1wIH0gZnJvbSAnZmlyZWJhc2UtYWRtaW4vZmlyZXN0b3JlJztcbmltcG9ydCBhZG1pbiBmcm9tICdmaXJlYmFzZS1hZG1pbic7IC8vIEltcG9ydCBhZG1pblxuaW1wb3J0IHsgYWRtaW5GaXJlc3RvcmUsIFBST0pFQ1RfSUQgfSBmcm9tICcuLi8uLi8uLi8uLi9qZXN0LmVtdWxhdG9yLnNldHVwLmpzJzsgLy8gQWRqdXN0IHBhdGggYXMgbmVlZGVkXG5pbXBvcnQge1xuICBnZXREZWFsc1Bhc3RGaW5hbEFwcHJvdmFsLFxuICBnZXREZWFsc1Bhc3REaXNwdXRlRGVhZGxpbmUsXG4gIHVwZGF0ZURlYWxTdGF0dXNJbkRCLFxufSBmcm9tICcuLi8uLi9kYXRhYmFzZVNlcnZpY2UuanMnOyAvLyBBZGp1c3QgcGF0aCBhcyBuZWVkZWRcbmltcG9ydCB7IGRlbGV0ZUFkbWluQXBwIH0gZnJvbSAnLi4vLi4vLi4vYXBpL3JvdXRlcy9hdXRoL2FkbWluLmpzJzsgLy8gQWRqdXN0IHBhdGggYXMgbmVlZGVkXG5cbi8vIEhlbHBlciB0byBjbGVhbiB1cCBGaXJlc3RvcmUgZGF0YVxuYXN5bmMgZnVuY3Rpb24gY2xlYW5VcEZpcmVzdG9yZSgpIHtcbiAgY29uc3QgY29sbGVjdGlvbnMgPSBhd2FpdCBhZG1pbkZpcmVzdG9yZS5saXN0Q29sbGVjdGlvbnMoKTtcbiAgZm9yIChjb25zdCBjb2xsZWN0aW9uIG9mIGNvbGxlY3Rpb25zKSB7XG4gICAgaWYgKGNvbGxlY3Rpb24uaWQgPT09ICdkZWFscycpIHsgLy8gT25seSBjbGVhciAnZGVhbHMnIGZvciB0aGVzZSB0ZXN0c1xuICAgICAgY29uc3QgZG9jcyA9IGF3YWl0IGNvbGxlY3Rpb24ubGlzdERvY3VtZW50cygpO1xuICAgICAgY29uc3QgZGVsZXRlUHJvbWlzZXMgPSBkb2NzLm1hcChkb2MgPT4gZG9jLmRlbGV0ZSgpKTtcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKGRlbGV0ZVByb21pc2VzKTtcbiAgICB9XG4gIH1cbn1cblxuZGVzY3JpYmUoJ0RhdGFiYXNlIFNlcnZpY2UgVGVzdHMnLCAoKSA9PiB7XG4gIC8vIFVzZSBhIHVuaXF1ZSBjb2xsZWN0aW9uIG5hbWUgZm9yIHRlc3RzIGlmIG5lZWRlZCwgb3IgZW5zdXJlIGNsZWFuIHNsYXRlXG4gIGNvbnN0IGRlYWxzQ29sbGVjdGlvbiA9IGFkbWluRmlyZXN0b3JlLmNvbGxlY3Rpb24oJ2RlYWxzJyk7XG4gIC8vIGxldCBkYjsgLy8gVGhpcyB3YXMgbm90IHVzZWQgbWVhbmluZ2Z1bGx5XG5cbiAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgICAvLyBFbnN1cmUgZW11bGF0b3JzIGFyZSBydW5uaW5nIGFuZCBjb25uZWN0ZWRcbiAgICBjb25zb2xlLmxvZyhgW0RCIFNlcnZpY2UgVGVzdHNdIFVzaW5nIFByb2plY3QgSUQ6ICR7UFJPSkVDVF9JRH0gYW5kIEZpcmVzdG9yZSBlbXVsYXRvci5gKTtcblxuICAgIC8vIEluaXRpYWxpemUgRmlyZWJhc2UgQWRtaW4gU0RLIGZvciB0ZXN0cyBpZiBub3QgYWxyZWFkeSBpbml0aWFsaXplZFxuICAgIC8vIFRoaXMgZW5zdXJlcyB0aGF0IGFkbWluLmZpcmVzdG9yZSgpIGluIGRhdGFiYXNlU2VydmljZS5qcyBjYW4gZmluZCB0aGUgZGVmYXVsdCBhcHBcbiAgICBjb25zdCBERUZBVUxUX0FQUF9OQU1FID0gJ1tERUZBVUxUXSc7XG4gICAgaWYgKCFhZG1pbi5hcHBzLmZpbmQoYXBwID0+IGFwcCAmJiBhcHAubmFtZSA9PT0gREVGQVVMVF9BUFBfTkFNRSkpIHtcbiAgICAgICAgY29uc29sZS5sb2coYFtEQiBTZXJ2aWNlIFRlc3RzIEJlZm9yZUFsbF0gSW5pdGlhbGl6aW5nIGRlZmF1bHQgRmlyZWJhc2UgYXBwIGZvciBkYXRhYmFzZVNlcnZpY2UgdGVzdHMuYCk7XG4gICAgICAgIGFkbWluLmluaXRpYWxpemVBcHAoe1xuICAgICAgICAgICAgcHJvamVjdElkOiBQUk9KRUNUX0lEIHx8IGBkYi1zZXJ2aWNlLXRlc3RzLSR7RGF0ZS5ub3coKX1gLCAvLyBVc2UgUFJPSkVDVF9JRCBmcm9tIGVtdWxhdG9yIHNldHVwXG4gICAgICAgICAgICAvLyBBZGQgb3RoZXIgY29uZmlndXJhdGlvbnMgaWYgbmVjZXNzYXJ5LCBlLmcuLCBzdG9yYWdlQnVja2V0LCBidXQgRklSRVNUT1JFX0VNVUxBVE9SX0hPU1Qgc2hvdWxkIGJlIHBpY2tlZCB1cFxuICAgICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhgW0RCIFNlcnZpY2UgVGVzdHMgQmVmb3JlQWxsXSBEZWZhdWx0IEZpcmViYXNlIGFwcCBhbHJlYWR5IGluaXRpYWxpemVkLmApO1xuICAgIH1cblxuICAgIC8vIGRhdGFiYXNlU2VydmljZS5qcywgd2hlbiBOT0RFX0VOViA9PT0gJ3Rlc3QnLCBzaG91bGQgbm93IHBpY2sgdXBcbiAgICAvLyB0aGUgZGVmYXVsdCBhcHAgaW5pdGlhbGl6ZWQgYnkgamVzdC5lbXVsYXRvci5zZXR1cC5qcyBvciBieSB0aGUgY29kZSBhYm92ZS5cbiAgfSk7XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgY2xlYW5VcEZpcmVzdG9yZSgpOyAvLyBDbGVhciAnZGVhbHMnIGNvbGxlY3Rpb24gYmVmb3JlIGVhY2ggdGVzdFxuICB9KTtcblxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgY2xlYW5VcEZpcmVzdG9yZSgpO1xuICAgIC8vIElmIGFkbWluQXBwIHdhcyBpbml0aWFsaXplZCBieSBkYXRhYmFzZVNlcnZpY2Ugb3IgaXRzIGltcG9ydHMsIGVuc3VyZSBpdCdzIGNsZWFuZWQgdXBcbiAgICAvLyBUaGlzIG1pZ2h0IGJlIGhhbmRsZWQgYnkgYSBnbG9iYWwgYWZ0ZXJBbGwgaW4gamVzdC5zZXR1cC5qcyBpZiBhZG1pbkFwcCBpcyBzaGFyZWRcbiAgICAvLyBGb3Igbm93LCBhc3N1bWluZyBqZXN0LmVtdWxhdG9yLnNldHVwLmpzIGhhbmRsZXMgaXRzIG93biBhZG1pbkFwcCBsaWZlY3ljbGUgb3IgaXQncyBtYW5hZ2VkIGVsc2V3aGVyZS5cbiAgICAvLyBhd2FpdCBkZWxldGVBZG1pbkFwcCgpOyAvLyBVbmNvbW1lbnQgaWYgYWRtaW5BcHAgdXNlZCBieSBzZXJ2aWNlIG5lZWRzIGV4cGxpY2l0IGNsZWFudXAgaGVyZVxuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0RGVhbHNQYXN0RmluYWxBcHByb3ZhbCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBkZWFscyB0aGF0IGFyZSBJTl9GSU5BTF9BUFBST1ZBTCBhbmQgcGFzdCB0aGVpciBkZWFkbGluZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG5vdyA9IFRpbWVzdGFtcC5ub3coKTtcbiAgICAgIGNvbnN0IG9uZUhvdXJBZ28gPSBUaW1lc3RhbXAuZnJvbU1pbGxpcyhub3cudG9NaWxsaXMoKSAtIDYwICogNjAgKiAxMDAwKTtcbiAgICAgIGNvbnN0IG9uZUhvdXJGcm9tTm93ID0gVGltZXN0YW1wLmZyb21NaWxsaXMobm93LnRvTWlsbGlzKCkgKyA2MCAqIDYwICogMTAwMCk7XG5cbiAgICAgIGF3YWl0IGRlYWxzQ29sbGVjdGlvbi5kb2MoJ2RlYWwxJykuc2V0KHtcbiAgICAgICAgc3RhdHVzOiAnSU5fRklOQUxfQVBQUk9WQUwnLFxuICAgICAgICBmaW5hbEFwcHJvdmFsRGVhZGxpbmVCYWNrZW5kOiBvbmVIb3VyQWdvLCAvLyBQYXN0IGRlYWRsaW5lXG4gICAgICAgIHByb3BlcnR5QWRkcmVzczogJzEyMyBNYWluIFN0JyxcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgZGVhbHNDb2xsZWN0aW9uLmRvYygnZGVhbDInKS5zZXQoe1xuICAgICAgICBzdGF0dXM6ICdJTl9GSU5BTF9BUFBST1ZBTCcsXG4gICAgICAgIGZpbmFsQXBwcm92YWxEZWFkbGluZUJhY2tlbmQ6IG9uZUhvdXJGcm9tTm93LCAvLyBGdXR1cmUgZGVhZGxpbmVcbiAgICAgICAgcHJvcGVydHlBZGRyZXNzOiAnNDU2IE9hayBBdmUnLFxuICAgICAgfSk7XG4gICAgICBhd2FpdCBkZWFsc0NvbGxlY3Rpb24uZG9jKCdkZWFsMycpLnNldCh7XG4gICAgICAgIHN0YXR1czogJ0FXQUlUSU5HX0ZVTEZJTExNRU5UJywgLy8gV3Jvbmcgc3RhdHVzXG4gICAgICAgIGZpbmFsQXBwcm92YWxEZWFkbGluZUJhY2tlbmQ6IG9uZUhvdXJBZ28sXG4gICAgICAgIHByb3BlcnR5QWRkcmVzczogJzc4OSBQaW5lIExuJyxcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgZGVhbHNDb2xsZWN0aW9uLmRvYygnZGVhbDQnKS5zZXQoe1xuICAgICAgICBzdGF0dXM6ICdJTl9GSU5BTF9BUFBST1ZBTCcsXG4gICAgICAgIGZpbmFsQXBwcm92YWxEZWFkbGluZUJhY2tlbmQ6IG9uZUhvdXJBZ28sIC8vIFBhc3QgZGVhZGxpbmVcbiAgICAgICAgcHJvcGVydHlBZGRyZXNzOiAnMTAxIE1hcGxlIERyJyxcbiAgICAgIH0pO1xuICAgICAgIGF3YWl0IGRlYWxzQ29sbGVjdGlvbi5kb2MoJ2RlYWw1Jykuc2V0KHtcbiAgICAgICAgc3RhdHVzOiAnSU5fRklOQUxfQVBQUk9WQUwnLFxuICAgICAgICAvLyBObyBkZWFkbGluZSBzZXQsIHNob3VsZCBub3QgYmUgcGlja2VkIHVwXG4gICAgICAgIHByb3BlcnR5QWRkcmVzczogJzIwMiBCaXJjaCBSZCcsXG4gICAgICB9KTtcblxuXG4gICAgICBjb25zdCBkZWFscyA9IGF3YWl0IGdldERlYWxzUGFzdEZpbmFsQXBwcm92YWwoKTtcbiAgICAgIGV4cGVjdChkZWFscykudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgZXhwZWN0KGRlYWxzLm1hcChkID0+IGQuaWQpLnNvcnQoKSkudG9FcXVhbChbJ2RlYWwxJywgJ2RlYWw0J10uc29ydCgpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGFuIGVtcHR5IGFycmF5IGlmIG5vIGRlYWxzIG1hdGNoJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgbm93ID0gVGltZXN0YW1wLm5vdygpO1xuICAgICAgY29uc3Qgb25lSG91ckZyb21Ob3cgPSBUaW1lc3RhbXAuZnJvbU1pbGxpcyhub3cudG9NaWxsaXMoKSArIDYwICogNjAgKiAxMDAwKTtcbiAgICAgIGF3YWl0IGRlYWxzQ29sbGVjdGlvbi5kb2MoJ2RlYWwxJykuc2V0KHtcbiAgICAgICAgc3RhdHVzOiAnSU5fRklOQUxfQVBQUk9WQUwnLFxuICAgICAgICBmaW5hbEFwcHJvdmFsRGVhZGxpbmVCYWNrZW5kOiBvbmVIb3VyRnJvbU5vdyxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgZGVhbHMgPSBhd2FpdCBnZXREZWFsc1Bhc3RGaW5hbEFwcHJvdmFsKCk7XG4gICAgICBleHBlY3QoZGVhbHMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldERlYWxzUGFzdERpc3B1dGVEZWFkbGluZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBkZWFscyB0aGF0IGFyZSBJTl9ESVNQVVRFIGFuZCBwYXN0IHRoZWlyIGRlYWRsaW5lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgbm93ID0gVGltZXN0YW1wLm5vdygpO1xuICAgICAgY29uc3Qgb25lRGF5QWdvID0gVGltZXN0YW1wLmZyb21NaWxsaXMobm93LnRvTWlsbGlzKCkgLSAyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgIGNvbnN0IG9uZURheUZyb21Ob3cgPSBUaW1lc3RhbXAuZnJvbU1pbGxpcyhub3cudG9NaWxsaXMoKSArIDI0ICogNjAgKiA2MCAqIDEwMDApO1xuXG4gICAgICBhd2FpdCBkZWFsc0NvbGxlY3Rpb24uZG9jKCdkaXNwdXRlMScpLnNldCh7XG4gICAgICAgIHN0YXR1czogJ0lOX0RJU1BVVEUnLFxuICAgICAgICBkaXNwdXRlUmVzb2x1dGlvbkRlYWRsaW5lQmFja2VuZDogb25lRGF5QWdvLCAvLyBQYXN0IGRlYWRsaW5lXG4gICAgICAgIHByb3BlcnR5QWRkcmVzczogJ0Rpc3B1dGUgUHJvcCAxJyxcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgZGVhbHNDb2xsZWN0aW9uLmRvYygnZGlzcHV0ZTInKS5zZXQoe1xuICAgICAgICBzdGF0dXM6ICdJTl9ESVNQVVRFJyxcbiAgICAgICAgZGlzcHV0ZVJlc29sdXRpb25EZWFkbGluZUJhY2tlbmQ6IG9uZURheUZyb21Ob3csIC8vIEZ1dHVyZSBkZWFkbGluZVxuICAgICAgICBwcm9wZXJ0eUFkZHJlc3M6ICdEaXNwdXRlIFByb3AgMicsXG4gICAgICB9KTtcbiAgICAgICBhd2FpdCBkZWFsc0NvbGxlY3Rpb24uZG9jKCdkaXNwdXRlMycpLnNldCh7XG4gICAgICAgIHN0YXR1czogJ0lOX0ZJTkFMX0FQUFJPVkFMJywgLy8gV3Jvbmcgc3RhdHVzXG4gICAgICAgIGRpc3B1dGVSZXNvbHV0aW9uRGVhZGxpbmVCYWNrZW5kOiBvbmVEYXlBZ28sXG4gICAgICAgIHByb3BlcnR5QWRkcmVzczogJ0Rpc3B1dGUgUHJvcCAzJyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBkZWFscyA9IGF3YWl0IGdldERlYWxzUGFzdERpc3B1dGVEZWFkbGluZSgpO1xuICAgICAgZXhwZWN0KGRlYWxzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3QoZGVhbHNbMF0uaWQpLnRvQmUoJ2Rpc3B1dGUxJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBhbiBlbXB0eSBhcnJheSBpZiBubyBkZWFscyBtYXRjaCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlYWxzID0gYXdhaXQgZ2V0RGVhbHNQYXN0RGlzcHV0ZURlYWRsaW5lKCk7XG4gICAgICBleHBlY3QoZGVhbHMpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3VwZGF0ZURlYWxTdGF0dXNJbkRCJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXBkYXRlIGRlYWwgc3RhdHVzIGFuZCBhZGQgYSB0aW1lbGluZSBldmVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlYWxJZCA9ICdkZWFsVG9VcGRhdGUnO1xuICAgICAgYXdhaXQgZGVhbHNDb2xsZWN0aW9uLmRvYyhkZWFsSWQpLnNldCh7XG4gICAgICAgIHN0YXR1czogJ0lOX0ZJTkFMX0FQUFJPVkFMJyxcbiAgICAgICAgcHJvcGVydHlBZGRyZXNzOiAnVXBkYXRlIFRlc3QgUHJvcCcsXG4gICAgICAgIHRpbWVsaW5lOiBbXSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBuZXdTdGF0dXMgPSAnQ09NUExFVEVEJztcbiAgICAgIGNvbnN0IGV2ZW50TWVzc2FnZSA9ICdEZWFsIGF1dG9tYXRpY2FsbHkgY29tcGxldGVkLic7XG4gICAgICBjb25zdCB0eEhhc2ggPSAnMHgxMjNhYmMnO1xuXG4gICAgICBhd2FpdCB1cGRhdGVEZWFsU3RhdHVzSW5EQihkZWFsSWQsIHtcbiAgICAgICAgc3RhdHVzOiBuZXdTdGF0dXMsXG4gICAgICAgIHRpbWVsaW5lRXZlbnRNZXNzYWdlOiBldmVudE1lc3NhZ2UsXG4gICAgICAgIGF1dG9SZWxlYXNlVHhIYXNoOiB0eEhhc2ggLy8gQXNzdW1pbmcgdGhpcyBpcyB0aGUgcmVsZXZhbnQgaGFzaCBmaWVsZCBiYXNlZCBvbiB1c2FnZVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHVwZGF0ZWREZWFsID0gYXdhaXQgZGVhbHNDb2xsZWN0aW9uLmRvYyhkZWFsSWQpLmdldCgpO1xuICAgICAgZXhwZWN0KHVwZGF0ZWREZWFsLmV4aXN0cykudG9CZSh0cnVlKTtcbiAgICAgIGNvbnN0IGRlYWxEYXRhID0gdXBkYXRlZERlYWwuZGF0YSgpO1xuICAgICAgZXhwZWN0KGRlYWxEYXRhLnN0YXR1cykudG9CZShuZXdTdGF0dXMpO1xuICAgICAgZXhwZWN0KGRlYWxEYXRhLnVwZGF0ZWRBdCkudG9CZUluc3RhbmNlT2YoVGltZXN0YW1wKTtcbiAgICAgIGV4cGVjdChkZWFsRGF0YS50aW1lbGluZSkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KGRlYWxEYXRhLnRpbWVsaW5lWzBdLmV2ZW50KS50b0JlKGV2ZW50TWVzc2FnZSk7XG4gICAgICBleHBlY3QoZGVhbERhdGEudGltZWxpbmVbMF0uc3lzdGVtVHJpZ2dlcmVkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGRlYWxEYXRhLnRpbWVsaW5lWzBdLnRyYW5zYWN0aW9uSGFzaCkudG9CZSh0eEhhc2gpO1xuICAgICAgZXhwZWN0KGRlYWxEYXRhLnRpbWVsaW5lWzBdLnRpbWVzdGFtcCkudG9CZUluc3RhbmNlT2YoVGltZXN0YW1wKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IHRocm93IGlmIGRlYWxJZCBpcyBpbnZhbGlkIGJ1dCBsb2cgYW4gZXJyb3IgKG9yIGhhbmRsZSBhcyBwZXIgaW1wbGVtZW50YXRpb24pJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uc29sZUVycm9yU3B5ID0gamVzdC5zcHlPbihjb25zb2xlLCAnZXJyb3InKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge30pO1xuICAgICAgYXdhaXQgdXBkYXRlRGVhbFN0YXR1c0luREIobnVsbCwgeyBcbiAgICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJywgXG4gICAgICAgIHRpbWVsaW5lRXZlbnRNZXNzYWdlOiAnVGVzdCBldmVudCcgXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChjb25zb2xlRXJyb3JTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBcIltEQlNlcnZpY2VdIEludmFsaWQgcGFyYW1ldGVycyBmb3IgdXBkYXRlRGVhbFN0YXR1c0luREI6XCIsXG4gICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgZGVhbElkOiBudWxsLCB1cGRhdGVEYXRhOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7IHN0YXR1czogJ0NPTVBMRVRFRCcgfSkgfSlcbiAgICAgICk7XG4gICAgICBjb25zb2xlRXJyb3JTcHkubW9ja1Jlc3RvcmUoKTtcbiAgICB9KTtcbiAgfSk7XG59KTsgIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBLFNBQVNBLElBQUksRUFBRUMsUUFBUSxFQUFFQyxFQUFFLEVBQUVDLE1BQU0sRUFBRUMsVUFBVSxFQUFFQyxRQUFRLEVBQUVDLFNBQVMsUUFBUSxlQUFlO0FBQzNGLFNBQVNDLFNBQVMsUUFBUSwwQkFBMEI7QUFDcEQsT0FBT0MsS0FBSyxNQUFNLGdCQUFnQixDQUFDLENBQUM7QUFDcEMsU0FBU0MsY0FBYyxFQUFFQyxVQUFVLFFBQVEsb0NBQW9DLENBQUMsQ0FBQztBQUNqRixTQUNFQyx5QkFBeUIsRUFDekJDLDJCQUEyQixFQUMzQkMsb0JBQW9CLFFBQ2YsMEJBQTBCLENBQUMsQ0FBQztBQUNuQyxTQUFTQyxjQUFjLFFBQVEsbUNBQW1DLENBQUMsQ0FBQzs7QUFFcEU7QUFDQSxlQUFlQyxnQkFBZ0JBLENBQUEsRUFBRztFQUNoQyxNQUFNQyxXQUFXLEdBQUcsTUFBTVAsY0FBYyxDQUFDUSxlQUFlLENBQUMsQ0FBQztFQUMxRCxLQUFLLE1BQU1DLFVBQVUsSUFBSUYsV0FBVyxFQUFFO0lBQ3BDLElBQUlFLFVBQVUsQ0FBQ0Ms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